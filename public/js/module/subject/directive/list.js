qh.getModule('subject').directive('subjectList', function() {
	return {
		restrict: 'A',
		scope: {orderString:"@", whereString:"@", limit:"@", offset:"@"},
		templateUrl: qh.getQHModule('subject').getPath()+"/partial/list.html",
		controller: ["$scope", "$attrs", "subject.factory.list", function($scope, $attrs, list) { //$scope.$watch("$attrs.chartName", function () {});
			// Perhaps 5 placeholders to stop the screen jumping around.
			// That would be generated by list.
			$scope.subjectList = [];

			var watchParams = [];
			var params = list.validateParams({});
			$.each(params, function(name) {
				watchParams[name] = "$attrs."+name;
			});
			$scope.$watchCollection("["+watchParams.join(",")+"]", function () {
				var params = list.validateParams($attrs);
				console.log(params);
				for(var i=0;i<params.limit*1;i++) {
					$scope.subjectList.push({});
				}
				list.fetch(params).then(function(response) {
					$scope.subjectList = response.data.subjects;
				});
			});
		}],
	};
});